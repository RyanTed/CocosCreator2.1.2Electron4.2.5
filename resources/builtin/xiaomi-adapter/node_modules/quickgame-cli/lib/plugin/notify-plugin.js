"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _path = _interopRequireDefault(require("path"));

var _child_process = _interopRequireDefault(require("child_process"));

var _utils = require("../utils");

/*
 * Copyright (C) 2017, hapjs.org. All rights reserved.
 */
function NotifyPlugin(options) {
  this.options = options;
}

NotifyPlugin.prototype.apply = function (compiler) {
  compiler.hooks.done.tap('NotifyPlugin', function () {
    // 发送通知
    var serverPath = _path["default"].join(__dirname, '../utils');

    var cmdStr = 'cd ' + serverPath + ' && node ./notify.js';

    _child_process["default"].exec(cmdStr, function (err, stdout, stderr) {
      _utils.colorconsole.log('### App Loader ### 请求手机自动刷新');

      err && _utils.colorconsole.log(err.message);
      stdout && _utils.colorconsole.log(stdout);
      stderr && _utils.colorconsole.log(stderr);
    });
  });
};

module.exports = NotifyPlugin;